# transFFIG-RATE

 Transcript Fiat Functional Intermediate Granules - by - Reliability and Trustworthiness Estimation
 
## Purpose

TransFFIG-RATE is a transcript aggregation methodology. Reference transcriptomes and *de novo* transcriptome assembly produce transcript expression variables that contain high uncertainty and variability. The unreliable nature of these transcript expression vectors precludes downstream scientific and clinical discoveries.

By aggregating the transcripts per gene according to function (sequence right now) into transcript groups (TGs), the statistical reliability of a transcript expression vector is increased. The transcripts are first compared using transffig_prep, which uses a user-defined MSA algorithm to determine their sequence distance matrix. This distance matrix is used to calculate a hierarchical clustering from gene to transcripts as end-point clusters. Every unique depth of the hierarchical clustering represents an intermediate granularity between gene and transcripts. For each of these granularities, we calculate relative statistical reliability and relative trustworthiness (biological precision). The granularity with the highest reliability + trustworthiness is extracted.

tl;dr - transFFIG-RATE increases the reliability and applicability of transcript expression, via transcript aggregation. 

## Installation

Requirements:
 - clustalo, MAFFT, MUSCLE, and T-Coffee (only the desired ones need to be installed)
 - SciPy
 - Numpy
 
TransFFIG-RATE can be installed with the following commands.

Using pip with Anaconda:

```console
cd ~/transFFIG-RATE
pip install .
```

Using setuptools:

```console
cd ~/transFFIG-RATE
python setup.py 
```

If you would like to place the installation into a specific prefix, add ``--prefix=<path>'' to the previous command line, where <path> is replaced with the specific prefix.

## Usage

TransFFIG-RATE is run through two steps: transffig\_prep and transffig\_rate. Transffig\_prep is initially run to calculate distance matrices used in transffig-rate.  

Help with either command can be accessed using:

```console
transffig_prep -h
transffig_rate -h
```

### transffig\_prep

transffig\_prep requires three preprocessed inputs:

1. GMAP output - the direct output of running the *de novo* transcriptome through GMAP.
2. *de novo* transcriptome FASTA - the transcriptome generated by the user using any *de novo* assembler.
3. A reference genome processed into the comma separated file: <gene name>,<chromosome>,<start>,<end>,<strand>.

```console
transffig_prep -g <gmap output file> -f <de novo fasta> -s <output directory> -c <number of concurrent jobs> -r <the reference genome>
```

### transffig\_rate

The inputs for transffig\_rate are outputs for transffig\_prep. This is so these sections can be run separately for generating MSA and running them through transFFIG-RATE for multiple MSA/projects separately.

```console
transffig_rate -t <FASTA output of transffig_prep> -p <MSA distance matrix directory> -o <output directory>
```

The output is a directory (-o) with the following files:

1. expression.csv - The expression table (csv) of the aggregated and unaggregated expression vectors.
2. transcript_groups.fastg - A file format similar to FASTA, but it is ordered. > gene, >> transcript
3. granularities.txt - A file containing all granularity values for all genes by all granularities.
4. reliabilities.txt - A file containing all reliability values for all genes by all granularities.
5. trustworthiness.txt - A file containing all trustworthiness values for all genes by all granularities.

The outputs 3-5 are all in the same format and ordered the same, so a granularity value has its corresponding reliabilities and trustworthiness values in the same location in the corresponding files.

# Contributing to transFFIG-RATE

TransFFIG-RATE has seen excellent results! Because of the value of this work, we are putting in the extra effort to make the publication high quality, so further iterations of transFFIG-RATE and competing tools can benefit you, the scientist. 

If you would like to contribute, email seanchristianwest@gmail.com.
If you would like to understand the statistics/biology, also email and I will send you some preliminary material (published in my dissertation) that will soon be published in a Journal article.